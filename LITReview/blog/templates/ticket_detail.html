{% extends "base.html" %}
{% load static %}

{% block content %}
<h1>{{ ticket.title }}</h1>
<p>Par {{ ticket.user }} le {{ ticket.time_created|date:"d/m/Y H:i" }}</p>
{% if ticket.image %}
    <img src="{{ ticket.image.url }}" alt="Image pour {{ ticket.title }}" class="ticket-image" />
{% endif %}
<p>{{ ticket.description }}</p>

<hr>

<h2>Commentaires</h2>
<ul class="review-list">
    {% for review in reviews %}
    <li class="review-item">
        <strong>{{ review.headline }}</strong> - note : {{ review.rating }}/5<br />
        <p>{{ review.body }}</p>
        <p>Par {{ review.user }} le {{ review.time_created|date:"d/m/Y H:i" }}</p>
        {% if review.user == request.user %}
            <a href="{% url 'review_update' review.pk %}">Modifier</a> |
            <form action="{% url 'review_delete' review.pk %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" onclick="return confirm('Confirmez-vous la suppression ?');">Supprimer</button>
            </form>
        {% endif %}
    </li>
    {% empty %}
    <li>Pas encore de commentaires.</li>
    {% endfor %}
</ul>

<hr>

<h2>Ajouter un commentaire</h2>

<form method="post" action="{% url 'review_create' ticket.pk %}">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit">Envoyer</button>
</form>

<hr>

<a href="{% url 'ticket_list' %}">Retour Ã  la liste des billets</a>

{% endblock %}
